<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/core-signals/core-signals.html">
<link rel="import" href="/bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/hero-transition.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/cross-fade.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/slide-down.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/slide-up.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/tile-cascade.html">
<link rel="import" href="/bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/bower_components/paper-dropdown/paper-dropdown.html">
<link rel="import" href="/bower_components/core-menu/core-menu.html">
<link rel="import" href="/bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="/bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="/bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="/bower_components/core-collapse/core-collapse.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/paper-slider/paper-slider.html">
<link rel="import" href="/bower_components/paper-dialog/paper-action-dialog.html">
<link rel="import" href="/bower_components/font-roboto/roboto.html">
<link href="../core-collapse/core-collapse.html" rel="import">

  <polymer-element name="george-product-results-grid" attributes="query">
  <template>

    <style>
      body{
        font-family: 'RobotoDraft', sans-serif;
      }
      /*chip*/
      .chip-container {
        position: absolute;
        right: 0;
        left: 0;
        text-align: center;
      }

      .chip {
        width:220px;
        height:280px;
        display: inline-block;
        position: relative;
        border-radius: 3px;
        margin: 4px;
        padding-top: 15px;
        padding-left: 10px;
        overflow: hidden;
        text-align: start;
        background-color: #fff;
        box-shadow: 0 2px 10px 0 rgba(0, 0, 0, 0.16);
      }

      .chip-top {
        width: 200px;
        height: 200px;
      }

      .chip-bottom {
        padding: 8px;
        line-height: 1.5;
      }

      .chip-product-title {
        font-weight: bold;
      }

      .chip-image{
        height:100%;
      }

      /*card layout*/
      .card {
        font-family: 'RobotoDraft', sans-serif;
        position: absolute;
        left:5%;
        top:10%;
        width: 90%;
        height: auto;
        margin-top:1%;
        border-radius: 3px;
        text-align: start;
        background: #fff;
        box-shadow: 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        background-image: linear-gradient(bottom, #FFFFFF 50%, {{selectedProduct.backgroundColour}} 50%);
        background-image: -o-linear-gradient(bottom, #FFFFFF 50%, {{selectedProduct.backgroundColour}} 50%);
        background-image: -moz-linear-gradient(bottom, #FFFFFF 50%, {{selectedProduct.backgroundColour}} 50%);
        background-image: -webkit-linear-gradient(bottom, #FFFFFF 50%, {{selectedProduct.backgroundColour}} 50%);
        background-image: -ms-linear-gradient(bottom, #FFFFFF 50%, {{selectedProduct.backgroundColour}} 50%);
      }

      .card-left {
        width: 35%;
        margin-top: 2%;
        margin-left: 2%;
      }

      .card-right {
        padding: 24px;
      }
      .card-top-right{
        height:55%;
      }
      .card-description{
        padding-top: 10%;
      }

      /*card contents*/
      .card-product-title {
        color:white;
        font-size: 3em;
        width:90%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .card-clothing {
        color:white;
        font-size: 1em;
      }

      .card-price {
        color:white;
        font-size: 3em;
        padding-right: 2%;
      }

      .card-image{
        width:100%;
        height:auto;
        max-height:20%;
        max-height: 600px;
        max-width: 500px;
      }

      .paper-icon-close{
        position: absolute;
        top:0px;
        right:0px;
        color: #fff;
      }
      .basket {
        background: #FFEB3B;
      }
      .inputs{
        display: inline-block;
      }
      .input span{
        color: white;
      }
      .input{
        float:left;
      }

      paper-dropdown-menu::shadow #label, paper-dropdown-menu::shadow #arrow {
        color: white !important;
      }
      paper-dropdown-menu::shadow #label {
        width: 110px;
      }
      paper-dropdown-menu{
        background-color: inherit;
        border-bottom: 1px solid white;
      }
      paper-fab{
        background: #FFEB3B;
        color: black;
        position:absolute;
        right:3%;
        bottom:50%;
      }

      /*hidef screen layout*/
      /*card tablet layout*/
      @media screen and (min-width: 1200px) {
        .card{
          min-height: 620px;
        }
        .card-description{
          padding-top: 8%;
        }
      }

      /*card tablet layout*/
      @media screen and (min-width: 481px) and (max-width: 1200px) {
        .card-product-title {
          font-size: 2em !important;

        }
        .card-price {
          font-size: 2em !important;
          float:left;
        }
      }
      /*card mobile layout*/
      @media screen and (max-width: 481px) {
        .card-product-title {
          font-size: 1em !important;
        }
        .card-price {
          font-size: 1em !important;
          float:left;
        }
        .forward-fab{
          display:none !important;
        }
        .card-description{
          padding-top: 15%;
          margin-left: -60%;
        }
      }

    </style>
    <core-animated-pages id="coreAnimatedPages" selected="{{page}}" transitions="hero-transition" on-core-animated-pages-transition-end="{{complete}}">

      <section>
        <div style="float: right; margin-top: 20px; margin-right: 20px; margin-bottom: 20px;">
          <paper-button raised on-click="{{filtersToggle}}" style="background: #FFEB3B;">Filter & Sort</paper-button>
        </div>

        <paper-action-dialog id="editableFilters" heading="Filter & Sort" transition="core-transition-top">
          <div>
            <h3>Filter by</h3>
            <div class="filter">
              <h4>Size</h4>
              <template repeat={{sizesFilter}}>
                  <span style="margin: 10px; display: inline-block;">
                    <paper-checkbox id="{{name}}" on-change={{selectionMade}} label="{{name}}" checked="{{checked}}"></paper-checkbox>
                  </span>
              </template>
            </div>
            <div class="filter">
              <h4>Colour</h4>
              <template repeat={{coloursFilter}}>
                  <span style="margin: 10px; display: inline-block;">
                    <paper-checkbox id="{{name}}" on-change={{selectionMade}} label="{{name}}" checked="{{checked}}"></paper-checkbox>
                  </span>
              </template>
            </div>
            <div class="filter">
              <h4>Price</h4>
              <template repeat={{pricesFilter}}>
                  <span style="margin: 10px; display: inline-block;">
                    {{label}}<br><paper-slider id="{{name}}" on-change={{selectionMade2}} min="{{min}}" max="{{max}}" value="{{value}}" pin editable></paper-slider>
                  </span>
              </template>
            </div>
          </div>
          <div>
            <h3>Sort by</h3>
            <div class="filter">
              <h4>Name</h4>
              <paper-radio-group selected="None">
                <template repeat={{alphabeticalOrdering}}>
                  <paper-radio-button id="{{list}}" on-change={{orderChanged}} label="{{name}}" checked="{{checked}}"></paper-radio-button>
                </template>
              </paper-radio-group>
            </div>
            <div class="filter">
              <h4>Price</h4>
              <paper-radio-group selected="None">
                <template repeat={{priceOrdering}}>
                  <paper-radio-button id="{{list}}" on-change={{orderChanged}} label="{{name}}" checked="{{checked}}"></paper-radio-button>
                </template>
              </paper-radio-group>
            </div>
          </div>
          <div style="float: right; clear: both;">
            <paper-button dismissive>Done</paper-button>
          </div>
        </paper-action-dialog>

        <div style="clear: both;"></div>

        <div class="chip-container" hero-p on-tap="{{transition}}">
          <template repeat="{{filteredItems as item}}">
            <div class="chip" hero-id="{{item.product}}-{{item.clothing}}" hero?="{{selectedProduct === item }}">
              <div class="chip-top" hero-id="{{item.product}}-{{item.clothing}}-art" hero?="{{selectedProduct === item}}">
                <img class="chip-image" src="{{item.image}}"/>
              </div>
              <div class="chip-bottom">
                <div class="chip-product-title">{{item.product}}</div>
                <div class="chip-clothing">Â£{{item.price}} - {{item.clothing}}</div>
              </div>
            </div>

          </template>

        </div>
      </section>

      <section>
        <div class="card" layout horizontal hero-id="{{selectedProduct.product}}-{{selectedProduct.clothing}}" hero>
          <paper-icon-button icon="clear" class="paper-icon-close" on-tap="{{transition}}"></paper-icon-button>
          <div class="card-left" hero-id="{{selectedProduct.product}}-{{selectedProduct.clothing}}-art" hero>
            <img class="card-image" src="{{selectedProduct.image}}"/>
          </div>
          <div class="card-right" flex two>
              <div class="card-top-right">
                <div class="card-product-title">{{selectedProduct.product}}</div>
                <div class="card-clothing">{{selectedProduct.clothing}}</div>
                <div class="card-price">Â£{{selectedProduct.price}}</div>
                <div class="inputs">
                  <div class="input">
                  <span>Size:</span>
                  <paper-dropdown-menu label="Select a Size">
                    <paper-dropdown id="sizeDropdown" class="dropdown">
                      <core-menu id="clothesSize" class="menu">
                        <template repeat="{{clothesSizeDropdown}}">
                          <paper-item value="{{}}">{{}}</paper-item>
                        </template>
                      </core-menu>
                    </paper-dropdown>
                  </paper-dropdown-menu>
                  </div>
                  <div class="input">
                  <span>Quantity:</span>
                  <paper-dropdown-menu label="Select Quantity">
                    <paper-dropdown id="quantityDropdown" class="dropdown">
                      <core-menu id="clothesQuantity" class="menu">
                        <template repeat="{{clothesQuantityDropdown}}">
                          <paper-item value="{{}}">{{}}</paper-item>
                        </template>
                      </core-menu>
                    </paper-dropdown>
                  </paper-dropdown-menu>
                  </div>
                </div>
                <div>
                  <paper-button class="basket" on-click='{{addToBasket}}'>Add to Basket</paper-button>
                </div>
              </div>
              <div flex two class="card-description">{{selectedProduct.description}} </br></br> {{selectedProduct.materials}} </br></br>Product Code: {{selectedProduct.productcode}}</div>
          </div>
        </div>
      </section>

    </core-animated-pages>
    <core-ajax id="resultsAjax" auto url="/bower_components/george-elements/results.json" handleAs="json"></core-ajax>
    <core-ajax id="ajax" auto url="/bower_components/george-elements/profiles.json" on-core-response="{{jsonLoaded}}" handleAs="json"></core-ajax>
  </template>
  <script>

    Polymer('george-product-results-grid', {

      page: 0,

      sizesFilter: [{name:6, checked:false},
                    {name:8, checked:false},
                    {name:10, checked:false},
                    {name:12, checked:false},
                    {name:14, checked:false},
                    {name:16, checked:false}],
      coloursFilter: [{name:'red', checked:false},
                      {name:'navy', checked:false},
                      {name:'blue', checked:false},
                      {name:'black', checked:false},
                      {name:'white', checked:false},
                      {name:'pink', checked:false},
                      {name:'grey', checked:false},
                      {name:'green', checked:false}],
      pricesFilter: [{min:0 , max:50, value:0, label:"Minimum", name:"Min"},
                      {min:0 , max:50, value:50, label:"Maximum", name:"Max"}],

      alphabeticalOrdering: [{name:'None', list:'alpha', checked:false, order:'None'},
                              {name:'A-Z', list:'alpha', checked: false, order:'Asc'},
                              {name:'Z-A', list:'alpha', checked: false, order:'Desc'}],
      priceOrdering: [{name:'None', list:'price', checked:false, order:'None'},
                        {name:'Low to High', list:'price', checked: false, order:'Asc'},
                        {name:'High to Low', list:'price', checked: false, order:'Desc'}],

      clothesSizeDropdown: [],
      clothesQuantityDropdown: [],
      selectedProduct: null,

      created: function(){

      },

      // Get the selected profile data from the cookie
      getSelectedProfileData: function() {
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
          var c = ca[i];
          while (c.charAt(0) == ' ') {
            c = c.substring(1);
          }
          if (c.indexOf("profileData=") != -1) {
            return JSON.parse(c.substring(12, c.length));
          }
        }
        return {
          "id": "-1"
        };
      },

      transition: function(e) {
        if (this.page === 0 && e.target.templateInstance.model.item) {
          this.selectedProduct = e.target.templateInstance.model.item;
          this.$.clothesQuantity.selected = null;
          this.clothesSizeDropdown = e.target.templateInstance.model.item.sizes;
          this.clothesQuantityDropdown = e.target.templateInstance.model.item.quantities;
          this.$.sizeDropdown.$.scroller.style.height = "";
          this.$.quantityDropdown.$.scroller.style.height = "";
          this.page = 1;
        } else {
          this.page = 0;
        }
      },

      nextProduct: function(e) {
        for (var i = 0; i < this.items.length; i++) {
          if (this.filteredItems[i].product == this.selectedProduct.product) {
            if (i+1 < this.filteredItems.length) {
              this.selectedProduct = this.filteredItems[i+1];
            } else {
              if (i+1 == this.filteredItems.length) {
                this.selectedProduct = this.filteredItems[0];
              }
            }
            break;
          }
        }
      },

      // Get a parameter from the url
      getUrlParam: function(key) {
        var url = window.location + "";
        var parameterString = url.substring(url.indexOf("?") + 1);
        var parameters = parameterString.split("&");
        for (var i = 0; i < parameters.length; i++) {
          if (parameters[i].split("=")[0].toLowerCase() == key && parameters[i].split("=").length > 1) {
            return parameters[i].split("=")[1];
          }
        }
        return "";
      },

      jsonLoaded: function() {
        if(this.$.resultsAjax.response === undefined || this.$.resultsAjax.response == null){
          window.location = document.URL;
        }
        else{
          this.items = this.$.resultsAjax.response.slice(0);
          for (var i = 0; i<this.items.length; i++) {
            var decimalPrice = this.items[i].price.toFixed(2);
            if(decimalPrice.substr(-2) == 00){
              this.items[i].price = decimalPrice.substr(0, decimalPrice.length-3);
            }
            else{
              this.items[i].price = decimalPrice;
            }
          }
          // Store the profile information in the this.profiles variable
          this.profiles = this.$.ajax.response.slice(0);
          var colours = this.getUrlParam("colours");
          var colourFilters = (colours === "") ? [] : colours.split(",");
          for(var j = 0; j < this.coloursFilter.length; j++){
            this.coloursFilter[j].checked = false;
          }
          for(var j = 0; j < this.coloursFilter.length; j++){
            for(var i = 0; i < colourFilters.length; i++){
              if(this.coloursFilter[j].name == colourFilters[i]){
                this.coloursFilter[j].checked = true;
              }
            }
          }
          this.runFilterSearch();
        }
      },

      getProductById: function(id) {
        for (var i = 0; this.items.length; i++) {
          if (this.items[i].id == id) {
            return [this.items[i]];
          }
        }
        return [];
      },

      runFilterSearch: function() {
        // Get the search term and parameters to filter by from the url
        var types = this.getUrlParam("types");
        var profiles = this.getUrlParam("profiles");
        var searchTerm = this.getUrlParam("search");
        var season = this.getUrlParam("season");
        var categories = this.getUrlParam("categories");
        var tags = this.getUrlParam("tags");
        var productid = this.getUrlParam("id");
        var clothesFilters = (types === "") ? [] : types.split(",");
        var profileFilters = (profiles === "") ? [] : profiles.split(",");
        var seasonFilter = (season === "") ? [] : season.split(",");
        var categoryFilters = (categories === "") ? [] : categories.split(",");
        var tagFilters = (tags === "") ? [] : tags.split(",");
        var colourFilters = [];

        if (productid !== "") {
          this.filteredItems = this.getProductById(productid);
          if (this.filteredItems.length != 0) {
            this.selectedProduct = this.filteredItems[0];
            this.$.clothesQuantity.selected = null;
            this.clothesSizeDropdown = this.selectedProduct.sizes;
            this.clothesQuantityDropdown = this.selectedProduct.quantities;
            this.$.sizeDropdown.$.scroller.style.height = "";
            this.$.quantityDropdown.$.scroller.style.height = "";
            this.page = 1;
          }
          return;
        }

        for(var j = 0; j < this.coloursFilter.length; j++){
          if(this.coloursFilter[j].checked == true){
            colourFilters.push(this.coloursFilter[j].name);
          }
        }
        var sizeFilters = [];
        for(var j = 0; j < this.sizesFilter.length; j++){
          if(this.sizesFilter[j].checked == true){
            sizeFilters.push(this.sizesFilter[j].name);
          }
        }
        var minPrice = this.pricesFilter[0].value;
        var maxPrice = this.pricesFilter[1].value;

        // Get the currently selected profile from the cookies
        var selectedProfile = this.getSelectedProfileData();

        // Filter down the products
        this.filteredItems = this.items;
        var that = this;
        this.filteredItems = this.items.filter(function(d, idx, array) {
          var matchesClothes = (clothesFilters.length == 0) ? true : false;
          var matchesColour = (colourFilters.length == 0) ? true : false;
          var matchesProfiles = (profileFilters.length == 0) ? true : false;
          var matchesSizes = (sizeFilters.length == 0) ? true : false;
          var matchesSeason = (seasonFilter.length == 0) ? true : false;
          var matchesCategories = (categoryFilters.length == 0) ? true : false;
          var matchesTags = (tagFilters.length == 0) ? true : false;
          var matchesPrices = false;

          // Does it match at least one of the clothes types detected
          for (var i = 0; i < clothesFilters.length; i++) {
            if (d.type == clothesFilters[i]) {
              matchesClothes = true;
            }
          }

          // Does it match at least one of the colours detected
          for (var i = 0; i < colourFilters.length; i++) {
            if (d.color == colourFilters[i]) {
              matchesColour = true;
            }
          }

          for (var i = 0; i < sizeFilters.length; i++) {
            var sizes = d.sizes;
            for(var j = 0; j < sizes.length; j++){
              if (sizes[j] == sizeFilters[i]) {
                matchesSizes = true;
              }
            }
          }

          for (var i = 0; i < seasonFilter.length; i++) {
            if (d.seasons === null) {
              matchesSeason = true;
              break;
            }

            if (seasonFilter != "all" && seasonFilter.length == 0) {
              matchesSeason = true;
              break;
            }

            for (var j = 0; seasonFilter != "all" && j < seasonFilter.length; j++) {
              if (seasonFilter[j] == d.seasons[j]) {
                matchesSeason = true;
              }
            }
          }

          if(minPrice <= d.price && d.price <= maxPrice){
            matchesPrices = true;
          }

          for (var i = 0; i < tagFilters.length; i++) {
            if (d.tags.indexOf(tagFilters[i]) > -1) {
              matchesTags = true;
            }
          }

          // Does it match the profile being used for this search (male/female, no sizes yet)
          // Alternatively, if categories given, does it match the categories and ignore the profiles
          if (categoryFilters.length > 0) {
            matchesProfiles = true;
            // TODO: Filter by category
            for (var i = 0; i < categoryFilters.length; i++) {
              var filter = categoryFilters[i];
              if ((filter == "men" || filter == "women") && (filter == d.clothing.toLowerCase() || d.clothing == "All Genders")) {
                matchesCategories = true;
              } else {
                if (d.categories.indexOf(filter) > -1) {
                  matchesCategories = true;
                }
              }
            }
          } else {
            for (var i = 0; i < profileFilters.length; i++) {
              var profile = { "id":"-1"};
              for (var j = 0; j < that.profiles.length; j++) {
                if (that.profiles[j].id == profileFilters[i]) {
                  profile = that.profiles[j];
                }
              }
              if (d.clothing == 'All Genders' || (profile.id != -1 && (d.clothing == 'Men' && profile.gender == 'm') || (d.clothing == 'Women' && profile.gender == 'f'))) {

                // TODO: Add checks for sizes, need to confirm how we're going to show profiles though - if we're sticking with numbers then the profiles need to be numbers - should be s, m, l, xl etc. though
                matchesProfiles = true;
              }
            }
          }

          // Now filter by the rest of the search terms in the title and the description
          var wordMatches = 0; var totalWords = 0;
          var searchTerms = searchTerm.split(" ");
          for (var i = 0; i < searchTerms.length && searchTerms[i] != ""; i++) {
            var regex = new RegExp(searchTerms[i], 'i');
            if (regex.test(d.product) || regex.test(d.description)) {
              wordMatches++;
            }
            totalWords++;
          }


          // Check to see if matches all filters and at least 50% of the search terms matched
          return matchesClothes && matchesTags && matchesColour && matchesSizes && matchesPrices && matchesProfiles && matchesSeason && matchesCategories && ((wordMatches == 0 && totalWords == 0) || (wordMatches/totalWords)*100 > 50);
        });
        this.orderingArray();
      },

      addToBasket: function(e, detail, sender) {
        var item = e.target.templateInstance.model.selectedProduct;
        if (this.$.clothesQuantity.selected === null) {
          // TODO: Add check for no size selecetd too
          alert("No quantity selected. Add some errof rot shi");
          return;
        }
        var itemComplete = {
          product: item.product,
          price: item.price,
          image: item.image,
          sizes: item.sizes[this.$.clothesSize.selected],
          quantity: item.quantities[this.$.clothesQuantity.selected],
          productcode: item.productcode,
          unique: Math.random()
        };
        this.fire('core-signal', {name:"basket-add", data:itemComplete});
      },

      filtersToggle: function() {
        this.$.editableFilters.toggle();
      },

      selectionMade: function(e, detail, sender) {
        this.runFilterSearch();
      },

      selectionMade2: function(e, detail, sender) {
        if(this.pricesFilter[0].value > this.pricesFilter[1].value){
          if(e.target.id == 'Max'){
            this.pricesFilter[1].value = this.pricesFilter[0].value;
          }else{
            this.pricesFilter[0].value = this.pricesFilter[1].value;
          }
        }
        this.runFilterSearch();
      },

      orderChanged: function(e){

        if(e.target.id == 'alpha'){
          for(var i = 0; i < this.alphabeticalOrdering.length; i++){
            if(this.alphabeticalOrdering[i].name == e.target.label){
              this.alphabeticalOrdering[i].checked = true;
            } else {
              this.alphabeticalOrdering[i].checked = false;
            }
          }
        }
        if(e.target.id == 'price'){
          for(var i = 0; i < this.priceOrdering.length; i++){
            if(this.priceOrdering[i].name == e.target.label){
              this.priceOrdering[i].checked = true;
            } else {
              this.priceOrdering[i].checked = false;
            }
          }
        }
        this.orderingArray();
      },



      orderingArray: function() {
        var alphaOrdering = '';
        var priceOrdering = '';
        var alphabetArray = this.alphabeticalOrdering;
        var priceArray = this.priceOrdering;
        for(var i = 0; i < alphabetArray.length; i++){
          if(alphabetArray[i].checked == true){
              alphaOrdering = alphabetArray[i].order;
          }
        }
        if(alphaOrdering == ''){
          alphaOrdering = 'None';
        }
        for(var i = 0; i < priceArray.length; i++){
          if(priceArray[i].checked == true){
              priceOrdering = priceArray[i].order;
          }
        }
        if(priceOrdering == ''){
          priceOrdering = 'None';
        }
        //console.log(this.priceOrdering);
        if(priceOrdering != 'None' && alphaOrdering == 'None'){
          for(var i = 0; i < this.filteredItems.length-1; i++){
            for(var j = 0; j < this.filteredItems.length-1; j++){
              var firstProduct = this.filteredItems[j];
              var secondProduct = this.filteredItems[j+1];
              if(priceOrdering == 'Asc' && firstProduct.price > secondProduct.price){
                this.filteredItems[j] = secondProduct;
                this.filteredItems[j+1] = firstProduct;
              }
              if(priceOrdering == 'Desc' && firstProduct.price < secondProduct.price){
                this.filteredItems[j] = secondProduct;
                this.filteredItems[j+1] = firstProduct;
              }
            }
          }
        }

        if(alphaOrdering != 'None'){
          for(var i = 0; i < this.filteredItems.length-1; i++){
            for(var j = 0; j < this.filteredItems.length-1; j++){
              var firstProduct = this.filteredItems[j];
              var secondProduct = this.filteredItems[j+1];
              if(alphaOrdering == 'Asc' && firstProduct.product > secondProduct.product){
                this.filteredItems[j] = secondProduct;
                this.filteredItems[j+1] = firstProduct;
              }
              if(alphaOrdering == 'Desc' && firstProduct.product < secondProduct.product){
                this.filteredItems[j] = secondProduct;
                this.filteredItems[j+1] = firstProduct;
              }
              if(priceOrdering == 'Asc' && firstProduct.product == secondProduct.product && firstProduct.price > secondProduct.price){
                this.filteredItems[j] = secondProduct;
                this.filteredItems[j+1] = firstProduct;
              }
              if(priceOrdering == 'Desc' && firstProduct.product == secondProduct.product && firstProduct.price < secondProduct.price){
                this.filteredItems[j] = secondProduct;
                this.filteredItems[j+1] = firstProduct;
              }
            }
          }
        }
      }

    });

  </script>
  </polymer-element>
