<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/paper-fab/paper-fab.html">
<link rel="import" href="/bower_components/core-ajax/core-ajax.html">

<script src="/bower_components/jquery/dist/jquery.js"></script>
<script src="/bower_components/slick.js/slick/slick.js"></script>

<polymer-element name="george-catalogues-carousel">

  <template>
    <style>
      .item {
        margin-left: 50px;
        margin-right: 50px;
        margin-bottom: 5px;
        margin-top: 5px
      }

      .item img {
        /* z=1 paper-shadow */
        box-shadow: 0 2px 10px 0 rgba(0, 0, 0, 0.16), 0 2px 5px 0 rgba(0, 0, 0, 0.26);
      }
    </style>

    <link rel="stylesheet" href="/bower_components/slick.js/slick/slick.css"/>

    <core-ajax id="ajax" auto url="/catalogues.json" on-core-response="{{cataloguesLoaded}}" handleAs="json"></core-ajax>

    <div id="carousel"></div>
  </template>

  <script>
    Polymer({
      orderedCatalogues: [],
      cataloguesLoaded: function() {
        this.catalogues = this.$.ajax.response.slice(0);
        this.inflateCarousel();
      },

      inflateCarousel: function() {
        $(this.$.carousel).slick({
              arrows: true,
              infinite: true,
              nextArrow: '<paper-fab mini icon="arrow-forward" class="slick-next"></paper-fab>',
              prevArrow: '<paper-fab mini icon="arrow-back" class="slick-prev"></paper-fab>',
              slidesToShow: 6,
              slidesToScroll: 6,
              responsive: [
                            {
                              breakpoint: 1600,
                              settings: {
                                slidesToShow: 5,
                                slidesToScroll: 5,
                              }
                            },
                            {
                              breakpoint: 1300,
                              settings: {
                                slidesToShow: 4,
                                slidesToScroll: 4,
                              }
                            },
                            {
                              breakpoint: 1024,
                              settings: {
                                slidesToShow: 3,
                                slidesToScroll: 3,
                              }
                            },
                            {
                              breakpoint: 600,
                              settings: {
                                slidesToShow: 2,
                                slidesToScroll: 2
                              }
                            },
                            {
                              breakpoint: 480,
                              settings: {
                                slidesToShow: 1,
                                slidesToScroll: 1
                              }
                            }
                          ]
        });

        this.reorderCatalogues();


        for (i = 0; i < this.orderedCatalogues.length; i++) {
            $(this.$.carousel).slickAdd("<div class='item'><img src='" + this.orderedCatalogues[i] + "'/></div>");
        }
      },

      reorderCatalogues: function(){
        var carouselSwitch = Math.round(Math.random()*4);
        var carouselTag;
        switch(carouselSwitch){
          case 0: carouselTag = 'raining';
          break;
          case 1: carouselTag = 'snowing';
          break;
          case 2: carouselTag = 'halloween';
          break;
          case 3: carouselTag = 'male';
          break;
          case 4: carouselTag = 'female';
          break;
        }
        console.log(carouselTag);
        for (i = 0; i < this.catalogues.length; i++) {
          if(this.catalogues[i].tag == carouselTag){
            this.orderedCatalogues = this.catalogues[i].carousel
          }
        }
      }
    });
  </script>
</polymer-element>
